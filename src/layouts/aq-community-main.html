<link rel='import' href='../../bower_components/iron-flex-layout/iron-flex-layout-classes.html'>
<link rel='import' href='../../bower_components/iron-pages/iron-pages.html'>

<link rel="import" href="../../bower_components/iron-lazy-pages/iron-lazy-pages.html">
<link rel="import" href="../../bower_components/iron-lazy-pages/iron-lazy-page.html">


<link rel='import' href='../../bower_components/app-route/app-route.html'>
<link rel='import' href='../../bower_components/app-route/app-location.html'>
<link rel='import' href='../../bower_components/app-route/app-route-converter.html'>

<link rel="import" href="../components/aq-toolbar.html">
<link rel="import" href="../components/community/aq-community-home.html">
<link rel="import" href="../components/community/aq-community-postdetail.html">
<link rel="import" href="../components/community/aq-community-createpost.html">

<dom-module id="aq-community-main">

  <template>

      <app-location route="{{route}}"></app-location>
      <app-route route="{{route}}"
                pattern="/dashboard/community/:threadId"
                data="{{routeData}}"
                active="{{active}}">
      </app-route>

      <iron-lazy-pages attr-for-selected = "page" selected="[[computeCommunityPage(active, routeData)]]">
          <template is='iron-lazy-page' page="home">
              <aq-community-home></aq-community-home>
          </template>

          <template is='iron-lazy-page' page="detail">
              <aq-community-postdetail thread-id="[[routeData.threadId]]"></aq-community-postdetail>
          </template>

          <template is='iron-lazy-page' page="create">
              <aq-community-createpost></aq-community-createpost>
          </template>
          
      </iron-lazy-pages>

  </template>

  <script>
    Polymer ({
      is: 'aq-community-main',

      properties:{
        routeData:{
          type:Object,
        },
      },

      listeners:{
        'postdetail-action':'onDetail',
      },

      computeCommunityPage: function(active, routeData) {
        if (active) {
            if (routeData.threadId == "create") {
                return "create";
            } else {
                return "detail"; 
            }
        } else {
            return "home";
        }
      },

    });
  </script>

</dom-module>
